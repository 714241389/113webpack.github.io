var ne=Object.defineProperty;var $=Object.getOwnPropertySymbols;var re=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var D=(e,n,r)=>n in e?ne(e,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[n]=r,f=(e,n)=>{for(var r in n||(n={}))re.call(n,r)&&D(e,r,n[r]);if($)for(var r of $(n))ae.call(n,r)&&D(e,r,n[r]);return e};import{c as M,a as I,b as W,d as t,m as b,S as B,e as L,o as j,f as oe,r as ie,g as p,s as k,h as V,t as se,i as J,j as z,k as le,l as x,n as O,u as ce,p as ue,E as de,q as ge,v as he,M as P}from"./index.0b0797f8.js";import{g as me}from"./getDeviceId.e8f3946a.js";import{g as T,a as R,s as C,c as N,B as w,b as y,d as Y,e as pe,u as fe}from"./Button.c1c2aac3.js";import{T as d,u as be,C as A,a as X,L as F,b as v,M as ve,c as Q,d as E,S as Ce,e as ye,I as xe}from"./IconButton.98bd67c8.js";import{C as Z,L as G}from"./CardActions.c5e64204.js";import{T as S}from"./TextField.71eb3b91.js";import{T as we}from"./index.3fcd7a1c.js";import"./isHostComponent.9ebad583.js";function Le(e){return R("MuiCardHeader",e)}const _=T("MuiCardHeader",["root","avatar","action","content","title","subheader"]),Se=M()({name:"MuiCardHeader",selfPropNames:["action","avatar","classes","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],propDefaults:({set:e})=>e({component:"div",disableTypography:!1}),utilityClass:Le,slotClasses:()=>({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]})}),Ie=C("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:(e,n)=>f({[`& .${_.title}`]:n.title,[`& .${_.subheader}`]:n.subheader},n.root)})({display:"flex",alignItems:"center",padding:16}),ke=C("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:(e,n)=>n.avatar})({display:"flex",flex:"0 0 auto",marginRight:16}),He=C("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:(e,n)=>n.action})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),Me=C("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:(e,n)=>n.content})({flex:"1 1 auto"}),ee=Se.component(function({allProps:n,classes:r,otherProps:i,props:a}){const c=s=>s instanceof HTMLElement&&s.classList.contains(d.toString()),u=I(()=>{const s=W(()=>a.title)();return s!==void 0&&!c(s)&&!a.disableTypography?t(d,b({get variant(){return a.avatar?"body2":"h5"},get className(){return r.title},component:"span",sx:{display:"block"}},()=>{var o;return(o=a.titleTypographyProps)!=null?o:{}},{children:s})):s}),g=I(()=>{const s=W(()=>a.subheader)();return s!==void 0&&!c(s)&&!a.disableTypography?t(d,b({get variant(){return a.avatar?"body2":"body1"},get className(){return r.subheader},component:"span",sx:{display:"block",color:"text.secondary"}},()=>{var o;return(o=a.subheaderTypographyProps)!=null?o:{}},{children:s})):s});return t(Ie,b(i,{get className(){return N(r.root,i.className)},ownerState:n,get children(){return[t(B,{get when(){return!!a.avatar},get children(){return t(ke,{get className(){return r.avatar},ownerState:n,get children(){return a.avatar}})}}),t(Me,{get className(){return r.content},ownerState:n,get children(){return[L(()=>u()),L(()=>g())]}}),t(B,{get when(){return!!a.action},get children(){return t(He,{get className(){return r.action},ownerState:n,get children(){return a.action}})}})]}}))});function Te(e){return R("MuiListItemIcon",e)}T("MuiListItemIcon",["root","alignItemsFlexStart"]);const Re=M()({name:"MuiListItemIcon",selfPropNames:["alignItems","children","classes"],propDefaults:({set:e})=>e({component:"div"}),utilityClass:Te,slotClasses:e=>({root:["root",e.alignItems==="flex-start"&&"alignItemsFlexStart"]})}),Ne=C("div",{name:"MuiListItemIcon",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:r}=e;return[n.root,r.alignItems==="flex-start"&&n.alignItemsFlexStart]}})(({theme:e,ownerState:n})=>f({minWidth:56,color:e.palette.action.active,flexShrink:0,display:"inline-flex"},n.alignItems==="flex-start"&&{marginTop:8})),q=Re.component(function({allProps:n,classes:r,otherProps:i,props:a}){const c=be(),u=b({get alignItems(){return c.alignItems}},n);return t(Ne,b(i,{get className(){return N(r.root,i.className)},ownerState:u,get children(){return a.children}}))}),U="magicbroad_jumpbackto",Ae=e=>{window.localStorage.setItem(U,e)},Fe=()=>window.localStorage.getItem(U),Ue=()=>{window.localStorage.removeItem(U)},$e=()=>{const e=Fe();return Ue(),e};function De(e){return typeof e=="object"?e===null:typeof e!="function"}function We(e){let n=e.get(),[r,i]=p(n),a=e.subscribe(c=>{i(c)});return j(()=>a()),r}function H(e){if(De(e.get()))return We(e);let n=e.get(),[r,i]=oe(n),a=e.subscribe(c=>{let u=ie(c);i(u)});return j(()=>a()),I(()=>r)}const Be=e=>{const[n,r]=p(""),[i,a]=p(""),c=H(k),u=H(V),g=se(),s=async()=>{k.set(n()),V.set(i()),await g.auth.signOut(),await g.removeAllSubscriptions(),e.onClose({},"configSet")},o=()=>{a(z.key),r(z.url)};return J(()=>{r(c()),a(u())}),t(ve,{get open(){return e.open},onClose:(l,h)=>e.onClose(l,h),get children(){return t(A,{sx:{maxWidth:"650px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",minWidth:"300px"},get children(){return[t(ee,{title:"Enter Supabase Details"}),t(X,{get children(){return[t(d,{children:"This selection helps you use another supabase instance instead the built-in one. The instance used here must allow auth callback url."}),t(F,{disablePadding:!0,get children(){return[t(v,{get children(){return t(S,{type:"url",sx:{width:"100%"},variant:"standard",label:"URL",get value(){return n()},fullWidth:!0,onChange:l=>r(l.target.value)})}}),t(v,{get children(){return t(S,{sx:{width:"100%"},variant:"standard",label:"Anon Key",get value(){return i()},multiline:!0,fullWidth:!0,onChange:l=>a(l.target.value)})}})]}}),t(d,{children:"Your account will be signed out and unsaved progress will be lost."})]}}),t(Z,{get children(){return[t(w,{onClick:o,get children(){return t(d,{children:"Use Default"})}}),t(y,{sx:{flexGrow:1}}),t(w,{onClick:()=>e.onClose({},"escapeKeyDown"),get children(){return t(d,{children:"Cancel"})}}),t(w,{onClick:s,get children(){return t(d,{children:"Set & Refresh"})}})]}})]}})}})};function Ve(e){return R("MuiLink",e)}const ze=T("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),K=M()({name:"MuiLink",autoCallUseClasses:!1,selfPropNames:["TypographyClasses","children","classes","color","underline","variant"],propDefaults:({set:e})=>e({color:"primary",component:"a",underline:"always",variant:"inherit"}),utilityClass:Ve,slotClasses:e=>({root:["root",`underline${Y(e.underline)}`,e.component==="button"&&"button",e.focusVisible&&"focusVisible"]})}),Pe={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},Ee=e=>Pe[e]||e,Ge=C(d,{name:"MuiLink",slot:"Root",overridesResolver:(e,n)=>{const{ownerState:r}=e;return[n.root,n[`underline${Y(r.underline)}`],r.component==="button"&&n.button]}})(({theme:e,ownerState:n})=>{const r=pe(e,"palette",Ee(n.color))||n.color;return f(f(f(f({},n.underline==="none"&&{textDecoration:"none"}),n.underline==="hover"&&{textDecoration:"none","&:hover":{textDecoration:"underline"}}),n.underline==="always"&&{textDecoration:"underline",textDecorationColor:r!=="inherit"?le(r,.4):void 0,"&:hover":{textDecorationColor:"inherit"}}),n.component==="button"&&{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${ze.focusVisible}`]:{outline:"auto"}})}),_e=K.component(function({allProps:n,otherProps:r,props:i}){const a=fe(),[c,u]=p(!1),g=b(n,{get focusVisible(){return c()}}),s=K.useClasses(g);return t(Ge,b({get className(){return N(s.root,r.className)},get classes(){return i.TypographyClasses},get color(){return i.color},onBlur:o=>{a.onBlur(o),a.isFocusVisibleRef.current===!1&&u(!1),typeof r.onBlur=="function"&&r.onBlur(o)},onFocus:o=>{a.onFocus(o),a.isFocusVisibleRef.current===!0&&u(!0),typeof r.onFocus=="function"&&r.onFocus(o)},ownerState:n,get variant(){return i.variant}},r,{get component(){return r.component},get children(){return i.children}}))}),qe=x('<svg><g><path d="M0,0h24v24H0V0z" fill="none"></path></g></svg>',6,!0),Ke=x('<svg><g><g><path d="M2,17h20v2H2V17z M3.15,12.95L4,11.47l0.85,1.48l1.3-0.75L5.3,10.72H7v-1.5H5.3l0.85-1.47L4.85,7L4,8.47L3.15,7l-1.3,0.75 L2.7,9.22H1v1.5h1.7L1.85,12.2L3.15,12.95z M9.85,12.2l1.3,0.75L12,11.47l0.85,1.48l1.3-0.75l-0.85-1.48H15v-1.5h-1.7l0.85-1.47 L12.85,7L12,8.47L11.15,7l-1.3,0.75l0.85,1.47H9v1.5h1.7L9.85,12.2z M23,9.22h-1.7l0.85-1.47L20.85,7L20,8.47L19.15,7l-1.3,0.75 l0.85,1.47H17v1.5h1.7l-0.85,1.48l1.3,0.75L20,11.47l0.85,1.48l1.3-0.75l-0.85-1.48H23V9.22z"></path></g></g></svg>',8,!0);var je=Q(()=>[qe.cloneNode(!0),Ke.cloneNode(!0)],"Password");const Je=x('<svg><path d="M0 0h24v24H0z" fill="none"></path></svg>',4,!0),Oe=x('<svg><path d="M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z"></path></svg>',4,!0);var Ye=Q(()=>[Je.cloneNode(!0),Oe.cloneNode(!0)],"ArrowBack");const Xe=x('<svg><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"></path></svg>',4,!0);var m;(function(e){e[e.Start=0]="Start",e[e.GitHubFlow=1]="GitHubFlow",e[e.PasswordFlow=2]="PasswordFlow"})(m||(m={}));const Qe=e=>{const n={width:32,height:32};return t(A,{sx:{minWidth:300},get children(){return[t(ee,{get title(){return t(d,{variant:"h6",children:"Sign in"})}}),t(d,{sx:{fontSize:14},color:"text.secondary",gutterBottom:!0,get children(){return t(y,{sx:{width:"100%",minWidth:360,bgcolor:"background.paper"},get children(){return t(F,{get children(){return[t(v,{disablePadding:!0,onClick:()=>e.onRequestNext({},m.GitHubFlow),id:"login-with-github",get children(){return t(E,{get children(){return[t(q,{get children(){return t(Ce,{sx:n,viewBox:"0 0 16 16",get children(){return Xe.cloneNode(!0)}})}}),t(G,{primary:"Sign in with GitHub"})]}})}}),t(v,{disablePadding:!0,onClick:()=>e.onRequestNext({},m.PasswordFlow),id:"login-with-password",get children(){return t(E,{get children(){return[t(q,{get children(){return t(je,{sx:n})}}),t(G,{primary:"Sign in with password"})]}})}})]}})}})}})]}})},Ze=e=>{const[n,r]=p(""),i=O(),[a,c]=p(""),[u,g]=p(!1),s=async()=>{g(!1);const o=new URL(window.location.href);o.search="";const{error:l}=await i.signIn({email:n(),password:a()},{redirectTo:o.toString()});if(l)if(l.status===400)g(!0);else throw l};return J(()=>{(n().length===0||a().length===0)&&g(!1)}),t(A,{sx:{minWidth:"360px"},get children(){return[t(ye,{get children(){return[t(xe,{size:"large",edge:"start",color:"inherit",sx:{mr:2},onClick:()=>e.onRequestNext({},m.Start),get children(){return t(Ye,{})}}),t(d,{variant:"h6",component:"div",sx:{flexGrow:1},children:"Sign in with your password"})]}}),t(X,{get children(){return t(F,{disablePadding:!0,get children(){return[t(v,{get children(){return t(S,{fullWidth:!0,label:"Email Address",variant:"standard",get value(){return n()},onChange:o=>r(o.target.value)})}}),t(v,{get children(){return t(S,{fullWidth:!0,label:"Password",variant:"standard",get value(){return a()},get helperText(){return L(()=>!!u(),!0)()?t(d,{variant:"inherit",color:"error",children:"Address or Password is Not Found"}):void 0},get error(){return u()},type:"password",onChange:o=>c(o.target.value)})}})]}})}}),t(Z,{sx:{justifyContent:"end",marginX:"14px"},get children(){return t(w,{get disabled(){return n().length===0||a().length===0},id:"sign-in-with-password-button",sx:{right:0},variant:"contained",disableElevation:!0,onClick:s,get children(){return t(d,{children:"Sign in"})}})}}),t(y,{sx:{height:"12px"}})]}})},ct=()=>{const e=O(),n=ce(),[r]=ue(),i=H(k),[a,c]=p(!1),[u,g]=p(m.Start),s=async()=>{const l=new URL(window.location.href);l.search="",await e.signIn({provider:"github"},{redirectTo:l.toString()})},o=async(l,h)=>{g(h),h===m.GitHubFlow&&await s()};return de((l,h)=>{if(h){me();const te=$e();h.user&&n(te||"/")}}),ge(()=>{const l=r.next;l&&l.length>0&&l.startsWith("/")&&!e.user()&&Ae(l)}),[t(we,{title:"Magicborad: Sign in"}),t(Be,{get open(){return a()},onClose:(l,h)=>{h==="configSet"&&window.location.reload(),c(!1)}}),t(y,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"},get children(){return[t(he,{get children(){return[t(P,{get when(){return u()===m.Start},get children(){return t(Qe,{onRequestNext:o})}}),t(P,{get when(){return u()===m.PasswordFlow},get children(){return t(Ze,{onRequestNext:o})}})]}}),t(y,{sx:{textAlign:"end"},get children(){return t(_e,{sx:{cursor:"pointer"},onClick:()=>c(!0),get children(){return t(d,{variant:"caption",get children(){return["Supabase Service: ",L(()=>new URL(i()).host)]}})}})}})]}})]};export{ct as default};
//# sourceMappingURL=index.22d4961c.js.map
